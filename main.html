
<!DOCTYPE html>
<html>
	<head>
        <link href="examples.css" rel="stylesheet" type="text/css">
        <link href="flot/jquery-ui.min.css" rel="stylesheet" type="text/css">
		<link rel="stylesheet" href="dist/leaflet.css" />
		<script src="dist/leaflet.js"></script>
		<script language="javascript" type="text/javascript" src="flot/jquery.min.js"></script>
        <script language="javascript" type="text/javascript" src="flot/jquery-ui.min.js"></script>
		<script language="javascript" type="text/javascript" src="flot/jquery.flot.min.js"></script>
        <script language="javascript" type="text/javascript" src="flot/jquery.flot.time.min.js"></script>
        <script language="javascript" type="text/javascript" src="flot/jquery.flot.resize.min.js"></script>
        <script language="javascript" type="text/javascript" src="flot/jquery.flot.navigate.min.js"></script>
        <script language="javascript" type="text/javascript" src="flot/jquery.flot.crosshair.min.js"></script>
	</head>
	<body>
        <div class="demo-container" style="width:800px; height:600px; float:left;">
            <div id="map" class="demo-placeholder" float="left"></div>
		</div>
        <div class="demo-container" style="width:600px; height:320px; float:left;">
            <div id="plot" class="demo-placeholder"></div>
		</div>
		<script>
            var plotDiv = $("#plot");
            var map = L.map('map').setView([47.15, 15.37],10);
            L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);
            var lG = L.layerGroup().addTo(map);
            var polyline = L.polyline([
                [47.15, 15.17],
                [47.26,15.30]
                ], {color:'red'}).addTo(map);
            var marker = 0 
            map.fitBounds(polyline.getBounds());
            lG.addLayer(polyline);

            $(function() {
                marker = L.marker(polyline.getBounds().getNorthEast()).addTo(map);
                // add an OpenStreetMap tile layer
                plotDiv.bind("plothover", function (event, pos, item) {
                    gui.onGraphHover(pos.x);
                    // axis coordinates for other axes, if present, are in pos.x2, pos.x3, ...
                    // if you need global screen coordinates, they are pos.pageX, pos.pageY
                    //if (item) {
                    //    highlight(item.series, item.datapoint);
                    //    printer.text("You hovered over " + pos.x + ", " + pos.y+", " +  item.datapoint);
                    //}
                });
                //plotDiv.bind("plotpan", function(event, plot) {
                //});
                plotDiv.bind("plotzoom", function(event, plot) {
                    //for (var x in Object.keys(plot.getYAxes())) {
                    //    printer.text("obj: "+x);
                    //}
                    var axes = plot.getAxes();
                    printer.text("zoom " + Object.keys(axes.yaxis) +" " + axes.yaxis.min + " " + axes.yaxis.max );
                    axes.yaxis.zoom();
                    //printer.text("a " + axes.xaxes);
                });
                $(".demo-container").resizable({
                    maxWidth: 1800,
                    maxHeight: 800,
                    minWidth: 450,
                    minHeight: 250,
                });
                plotDiv.resize(function () {
                    printer.text("Placeholder is now "
                        + $(this).width() + "x" + $(this).height()
                        + " pixels");
                });
                $("#map").resize(function(){
                    map.invalidateSize(true);
                    printer.text("map resize"+ map.getSize());
                });
                printer.text("win size: "+window.size);
            });

			function setLine(polD,col) {
                var p = L.polyline(polD,{color:col});//.addTo(map);
                map.addLayer(p);
                lG.addLayer(p);
                map.fitBounds(p.getBounds());
			}
            function moveMarker(ltlg) {
                marker.setLatLng(ltlg);
            }
			function showPlot(data) {
                printer.text("data");
                $.plot(plotDiv, data ,{
                    xaxis: { mode: "time", timeformat: "%H:%M:%S", zoomRange: [1], }, 
                    yaxis: { zoomRange: false },
                    crosshair: { mode: "x" },
                    grid: { hoverable: true, autoHighlight: false },
                    zoom: { interactive: true },
                    pan: { interactive: true },
                    } 
                );
            }

            function clearMap() {
                lG.clearLayers();
                //for (p in polys) {
                //    map.removeLayer(polys.pop());
                //}
            }

		</script>
	</body>
</html>

